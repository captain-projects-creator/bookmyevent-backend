<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Event Booking â€” Calendar + Available Events</title>

    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />

    <!-- Your styles -->
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="site-header" role="banner" style="background:#fff;box-shadow:0 1px 0 rgba(0,0,0,0.04);position:relative;">
    <div class="header-inner" style="max-width:1200px;margin:0 auto;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;">
        <div style="display:flex;align-items:center;gap:18px;">
            <h1 style="margin:0;font-size:18px;">Event Booking System</h1>
            <nav aria-label="Main navigation">
                <a id="navHome" href="index.html" style="margin-right:12px;text-decoration:none;color:#0b5ed7">Home</a>
                <!-- Admin link will be toggled by JS depending on JWT -->
                <a id="navAdmin" href="admin.html" style="margin-right:12px;text-decoration:none;color:#6b21a8; display:none;">Admin</a>
                <a id="navTickets" href="my_tickets.html" style="text-decoration:none;color:#059669">My Tickets</a>
            </nav>
        </div>

        <!-- Right-side small controls (welcome + logout) -->
        <div id="rightControls" style="display:flex;align-items:center;gap:12px;">
            <span id="welcomeMsg" style="display:none; font-weight:600; color:#111827;"></span>
            <button id="logoutBtn" style="display:none; padding:8px 12px; border-radius:8px; border:none; background:#ef4444; color:#fff; cursor:pointer;">Logout</button>
        </div>
    </div>

    <!-- USER ICON (top-right fixed) -->
    <button id="userIcon" aria-haspopup="true" aria-expanded="false" title="Account"
            style="position:fixed;right:16px;top:12px;width:44px;height:44px;border-radius:22px;border:none;background:#eef2ff;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1300;">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 12c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5zM4 20c0-3.866 3.582-7 8-7s8 3.134 8 7v1H4v-1z" fill="#1f2937"/>
        </svg>
    </button>

    <!-- Floating mini panel anchored to the right (hidden by default) -->
    <div id="userPanel" role="dialog" aria-hidden="true"
         style="position:fixed;right:16px;top:66px;width:340px;background:#fff;border-radius:12px;box-shadow:0 12px 30px rgba(15,23,42,0.14);padding:16px;display:none;z-index:1400;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
            <strong id="panelTitle">Login</strong>
            <button id="closeUserPanel" aria-label="Close" style="background:transparent;border:none;font-size:20px;cursor:pointer;">&times;</button>
        </div>

        <div style="display:flex;gap:8px;margin-bottom:12px;">
            <button id="tabLogin" class="small-tab active">Login</button>
            <button id="tabRegister" class="small-tab">Register</button>
        </div>

        <!-- PROFILE VIEW (shown when logged in) -->
        <div id="profileView" style="display:none;">
            <div style="margin-bottom:12px;">
                <div style="font-size:13px;color:#6b7280;">Signed in as</div>
                <div id="profileUsername" style="font-weight:700;font-size:16px;margin-top:6px;color:#111827;"></div>
            </div>

            <div style="display:flex;flex-direction:column;gap:8px;">
                <a id="myTicketsLink" href="my_tickets.html" class="btn" style="text-align:center;text-decoration:none;display:block;">My Tickets</a>
                <a id="adminLink" href="admin.html" class="btn secondary" style="text-align:center;text-decoration:none;display:none;">Admin</a>
                <button id="profileLogoutBtn" class="btn" style="background:#ef4444;border:none;color:#fff;">Logout</button>
            </div>
        </div>

        <!-- LOGIN FORM -->
        <form id="miniLoginForm" style="display:block;">
            <input id="miniUsername" placeholder="Username" required />
            <input id="miniPassword" type="password" placeholder="Password" required />
            <div style="display:flex;gap:8px;margin-top:12px;">
                <button id="miniLoginBtn" type="button" class="btn">Login</button>
            </div>
            <div id="miniLoginMsg" style="margin-top:8px;color:#b91c1c"></div>
        </form>

        <!-- REGISTER FORM -->
        <form id="miniRegisterForm" style="display:none;">
            <input id="regUsername" placeholder="Username" required />
            <input id="regPassword" type="password" placeholder="Password" required />
            <input id="regPassword2" type="password" placeholder="Repeat password" required />
            <input id="regMobile" placeholder="Mobile number (optional)" />
            <input id="regEmail" placeholder="Email (optional)" />
            <div style="display:flex;gap:8px;margin-top:12px;">
                <button id="miniRegisterBtn" type="button" class="btn">Register</button>
            </div>
            <div id="miniRegisterMsg" style="margin-top:8px;color:#b91c1c"></div>
        </form>
    </div>
</header>

<main class="layout" role="main" style="max-width:1200px;margin:20px auto;padding:0 16px;">
    <!-- LEFT: Calendar -->
    <section class="left" aria-labelledby="calendar-heading">
        <h2 id="calendar-heading" style="display:none">Calendar</h2>
        <div id="calendar" role="region" aria-label="Events calendar"></div>
    </section>

    <!-- RIGHT: Available events list -->
    <aside class="right" aria-labelledby="events-heading">
        <div class="right-card" style="padding:16px;">
            <h2 id="events-heading">Available Events</h2>

            <label for="searchInput" class="visually-hidden">Search events</label>
            <input id="searchInput" type="search" placeholder="Search events..." aria-label="Search events" />

            <!-- Horizontal scroll strip with left/right controls -->
            <div style="position:relative;margin-top:12px;">
                <button id="scrollLeft" class="scroll-left" title="Scroll left" aria-hidden="true">&#10094;</button>
                <div id="eventsStrip" class="events-strip" aria-live="polite" style="padding:12px 6px;"></div>
                <button id="scrollRight" class="scroll-right" title="Scroll right" aria-hidden="true">&#10095;</button>
            </div>

            <div id="loading" class="muted" style="margin-top:12px;">Loading...</div>
            <div id="message" role="status" style="margin-top:8px;color:#b91c1c;"></div>
        </div>
    </aside>
</main>

<!-- FullCalendar + app logic -->
<script defer src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script defer src="app.js"></script>

</body>
</html>